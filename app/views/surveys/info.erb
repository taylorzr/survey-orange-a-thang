<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {

        var options = {
          title:'Sample Question', color: '000', opacity: 0.5,
          vAxis: {title: 'Reponse Options',  titleTextStyle: {color: '000', opacity: 0.5}},
          backgroundColor: '#FF8C00'
        };

      	<% @survey.questions.each do |question| %>
        var data<%= question.id %> = google.visualization.arrayToDataTable([
          ["Choice", "Number of Responses"],
          <% question.choices.each do |choice| %>
          ['<%= choice.text %>', <%= choice.answers.count %>],
          <% end %>
          ]);


        var chart<%= question.id %> = new google.visualization.BarChart(document.getElementById('chart_div<%= question.id %>'));

        chart<%= question.id %>.draw(data<%= question.id %>, options);
      <% end %>
  	}
</script>

<h1><%= @survey.name %></h1>
<% @survey.questions.each do |question| %>
<div id="chart_div<%= question.id %>" style="width: 700px; height: 500px"></div>
<% end %>